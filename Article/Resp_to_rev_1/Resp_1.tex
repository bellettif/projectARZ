\documentclass{article}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{mathrsfs}
\usepackage{float}
\usepackage{graphics}
\usepackage{graphicx}

\DeclareMathOperator{\card}{card}
\DeclareMathOperator{\trc}{trace}
\DeclareMathOperator{\mean}{mean}
\DeclareMathOperator{\bin}{bin}
\DeclareMathOperator{\lns}{lanes}
\DeclareMathOperator{\cnt}{count}

\bibliographystyle{elsarticle-num}

\begin{document}

\begin{figure}
\includegraphics[width=1\columnwidth]{berkeley-letterhead.jpg}
\end{figure}

\hfill{}Electrical Engineering and Computer Science \\
Francois Belletti \hfill{}652 Sutardja Dai Hall \\
Ph.D. Student\hfill{}\hfill{}Berkeley, California 94720-1710\\
Tel. 510-219-1493 \\
Email: francois.belletti@berkeley.edu\hfill{}\today

\bigskip{}

\bigskip{}
\textbf{Object:} Revised version of the article \textit{Prediction of traffic convective instability with spectral analysis of the Aw--Rascle--Zhang model}
 by Belletti, Huo, Litrico, Bayen, (ref No PLA-D-15-00317) for publication in Physics Letters A.

\bigskip{}

The authors are very grateful to the two referees for their
reports sent on March 19, 2014, and their careful reading of the
paper. The revised version takes into account all their recommendations
and suggestions, which we feel greatly improve the article.\\

We now address point by point all comments of the reviewers (presented
here in italic).

\bigskip{}


\section{Reviewer A:}

\emph{
This paper performs spectral analysis on linearized ARZ model by removing the time variable with Laplace transform, deriving the distributed transfer function (state-transition matrices), and converting the results back into time domain. Simulations based on NGSIM data show that this spectral analysis well describes the convective instability. The idea of transforming ARZ model into ODE and taking advantage of well-developed linear system and control theory is novel and worth exploring. The methodology is solid and the results are interesting. However, there are a few issues that must be clarified. The suggestions below are given to improve the quality of the paper.
}

We thank the reviewer for their positive assessment of our work, and the nice remarks on our contributions. We have followed their suggestion of related works, clarifications and more thorough analysis of the analysis of the system under study.\\

\bigskip{}

\emph{
The authors shall refer to two recent papers on convective instability and highlight the difference between the different approaches taken: M. Treiber and A. Kesting, Evidence of convective instability in congested traffic flow: a systematic empirical and theoretical investigation, Transportation Research Part B, Volume 45, Issue 9, pp 1362-1377, 2011 ; J. A. Ward and R. E. Wilson, Criteria for convective versus absolute string instability in car-following models, Proceedings of the Royal Society A, Volume 467, Issue 2132, pp. 2185-2208, 2011.)
}

We fully agree that these two articles are quite important when it comes highlighting the cause and consequences of convective instability in vehicular traffic.

The first article considers a definition of convective instability which, like ours, corresponds to growing perturbations that propagate out of the solution domain but, unlike ours, requires linear instability as well. This study nonetheless strongly relates to ours in that it investigates how macroscopic models and spectral analysis can show how such phenomena arise in traffic. Our conclusions complement those of Treiber and Kesting in that we investigate convective instability that arises in free-flow and propagates downstream whereas their study focuses on similar instability that propagates upstream in congested traffic.

The second article, by Ward and Wilson also exclusively focuses on convective instability that travels upstream as opposed to the direction we find in free flow regime. While our study considers macroscopic models, Ward and Wilson deal with car following models. What is similar however is how their spectral analysis of linearized models highlights to propagation speeds, the group speed which corresponds to cars, and the signal speed which relates to how fast information propagates in the traffic medium.

WHAT WE HAVE CHANGED

WHERE TO FIND IT

\bigskip{}

\emph{
Elements in the state-transition matrices are found to contain time delay terms and distributed gains. These terms may relate to microscopic car-following models with delayed acceleration feedback terms which result in similar spectrum than hyperbolic PDE models forced with dissipative terms. J. I. Ge and G. Orosz, Dynamics of connected vehicle systems with delayed acceleration feedback, Transportation Research Part C, Volume 46, pp 46-64 2014. Such connections shall be discussed by the authors.
}

We thank the reviewer for bringing this article to our attention. Reaction time at the microscopic level does play an important role in the AW-Rascle-Zhang model and it would be very interesting to recalibrate this macroscopic model to account for intelligent cars. 

However, our method is more similar to that of Ward and Wilson cited in the first remark. Indeed, only first order time derivative terms appear in our equations when in the connected cruise control scenario considered by Ge and Orosz, acceleration is core to the analysis. Fundamentally, our approach differs from this microscopic model in that it considers a coarser space and time scale. 

Still, information propagation delay stemming from drivers' reaction time or communication between cars would change to the relaxation time in the Aw-Rascle-Zhang model however although this latter model only considers aggregate traffic behavior.

WHAT WE HAVE CHANGED

WHERE TO FIND IT

\bigskip{}

\emph{
The authors shall elaborate on why the state-transition model for $F>1$ has both $\xi(0,s)$ and $\xi(L,s)$ as inputs (eq. 42), while for $F<1$ $\xi(0,s)$ is input and $\xi(L,s)$ is output (eq. 37).
}

Indeed, it seems that the way we introduce the definition of the outputs and inputs depending on the traffic regime is not clear enough in our article.
If F < 1 (ie congested regime) the characteristic lines are both going downstream and therefore solving the linearized ARZ Partial Differential Equation is well defined if an initial condition is set and the upstream boundary condition is determined.
If F < 1 (ie free flow regime) however, the characteristic line determining $\xi_1$ flow downstream whereas that of $\xi_2$ flows upstream. Therefore, an upstream boundary condition determines $\xi_1$ in the solution domain and a downstream boundary condition determines $\xi_2$ in the solution domain.

WHAT WE HAVE CHANGED

WHERE TO FIND IT

\emph{
In Section 3.3.4, the authors checked the poles of the transfer function, but did not quite provide results on BIBO stability, which would require calculating the norm of the transfer function.
}

We fully agree that computing the poles was not sufficient. In order to keep the study relatively concise we did not compute the  $H_{\infty}$ norm of the transfer function. 

In free-flowing regime, it corresponds to the maximum module of eigen value of the matrix $\Psi$. The spectrum of $\Psi$ is identical to that of $\Phi$ which is lower triangular and has eigenvalues 
$
e^{ - \frac{x}{\tau \lambda_1}}
e^{ - \frac{x}{\lambda_1} s}
$
and
$
e^{ - \frac{x}{\lambda_2} s}
$
whose module is trivially bounded by $1$.
This proves the $H_{\infty}$ norm of $Psi$ is $1$ and therefore the system is BIBO stable.

In congested regime let us consider the eigenvalues of matrix $\Theta$ which are identical to that of $\Gamma$.
The latter is lower triangular and its eigen values also have a module bounded by $1$.
The congested regime system is therefore also BIBO.

WHAT WE HAVE CHANGED

WHERE TO FIND IT

\emph{
It is established that the linearized ARZ model is stable to adequately describe convective instability through numerical validation. It would be nice to see more on how this method can be used in traffic control.
}

We agree that this is worth exploring. As stated in the article, our work here follows that of Litrico on the Saint-Venant equations. The reviewer may refer to Part II of \cite{Litricobook} for a glance at the work left to be done on the ARZ model. There are various possibilities employing the classical control techniques. For instance, we could design a PI controller for controlling $q$ at $x = L$ using the transfer matrices from $q$ at $x = 0$ and $v$ at either $x = 0$ or $x = L$, depending on the flow regime. We may approximate the transfer functions with the integrator delay model, such as in \cite{Litricosimp}, for tuning the gains. 

However, as the design of a working controller is more involved and out of the scope of the present article, this will be provided in a future article. Ultimately our aim is to explore in depth such control methods and assess how well they apply to traffic with linearized equations. In particular, this corresponds to the practical setting of the Bay Bridge near San Francisco that controls flow entering the city with traffic signals on the other side of the bridge. \\

\bigskip{}

\emph{
After turning PDE into ODE for theoretical analysis in frequency domain, we often have to translate the results back into time domain, which can be very tricky. I was wondering whether this method would work for other PDE traffic models as well or the algebra gets much more complicated.
}

The reviewer raises an very insightful point here. In the ARZ equation settings, our derivations have yielded transfer functions that allow rather easily one to find explicit formulae for the time domain expression of responses to various families of inputs such as steps and cosines. Thanks to this we derived generic analytical time domain expressions for any Fourier decomposition of a function.
With other expressions for the transfer function, it might not be possible to calculate such analytical expressions. However, two techniques can then be used.

The first one, differential flatness (\cite{1184520}), allows one to expression the appropriate input for a desired output thanks to a decomposition as an infinite polynomial sum.

The second one, numerical derivation of Laplace transforms, relies on numerical derivations of Laplace and inverse Laplace transform (\cite{inverse}). It can be computationally expensive but is embarrassingly parallel.

Our article focuses on the ARZ equations for traffic therefore and exploring this very interesting remark would require writing an entire new section and introducing new equations and derivations. Reviewer B has pointed out that our article should be shorter in order to correspond to the usual length of papers published in Physics Letters A therefore we believe we are out of space.


\newpage

\section{Reviewer B}
\emph{
The present manuscript deals with classical Aw-Rascle-Zhang (ARZ) model for freeway traffic and proposed a spectral analysis of its linearized version. NGSIM data for congested traffic trajectories is used to validate the theoretical predictions. Though, the results presented in this article are interesting and useful but still I propose that the article should be rewritten and the following changes should be made.
}
The reviewer is correct in pointing out that the submitted version of the article was lacking several important references in the literature of traffic models and related control. We have found the suggested references to be helpful in placing the article in a broader context. We have elaborated on the suggested literature in the edits within the article and again in the responses below. We have also made the notations more transparent as requested and conducted a thorough analysis of the errors in our numerical assessment of the model. The article is also now much in order to correspond to the standards of Physics Letters A.\\

\bigskip{}

\emph{
The last line of the abstract is difficult to understand for the reader of this article.
}
We agree with that remark and thank the reviewer for pointing the lack of clarity of this sentence.
More precise terms are now used and the previous sentence (``In particular, it replicates the propagation of boundary conditions’ oscillations into the interior resolution domain of the PDE under study.'') has been changed to ``In particular, it accounts for the advection of oscillations on boundaries into the interior domain where the PDE under study is solved.''. Indeed, this reflects that, in the linearized equation, it is advection that is responsible for propagating information from the boundaries into the resolution domain and avoids the confusing term ``propagation''.

\bigskip{}

\emph{
The article length does not suit to be published in Physics Letters A. In my opinion, the introduction part can be rewritten in a shorter way and the other sections can also be squeezed without missing the relevant information.
}


We fully agree that the article can be presented in a more concise manner without losing too much of the study. The article has been entirely rewritten so as to much better conform with the standards of Physics Letters A. The list of corresponding changes is presented below:
\begin{itemize}
\item
\emph{Section 1: Introduction}
The preamble has been shortened and subsections 1.1, 1.2, 1.3 (formerly pages 1, 2, 3) have been merged in an introductory subsection on \textit{Traffic macroscopic models} (now subsection 1.1 on page 1). It presents first order and second order models in a more condensed manner.

Subsections 1.4 and 1.5 (formerly page 3) have been merged and made more concise as their common objective is to highlight the aim of our linearization strategy and how it was inspired on analogous work on the Saint-Venant equations. They now correspond to subsection 1.2 (page 2) named \text{Models appropriate for control}.

Subsection 1.6, \textit{Approach and contribution} (formerly page 3, now page 2), has been slightly modified. Itemization has been turned into a series of more compact paragraphs. The message conveyed by each iterm has not been modified but a thorough rewording has allowed a more concise formulation.

Subsection 1.4 The last sentence was redundant with explanations written later on. It has been deleted for the sake of concision.

\item
\emph{Section 2: Spectral analysis of the linearized ARZ model}
The items in subsection 3.2.1 formerly on page 9 have been gathered in a single paragraph on page 5 in the same subsection. 

Subequations (45 a-b-c-d) formerly on page 10 have been rearrange into equation into equation (30) on page 9. Redundant elements with equations (43 a-b-c-d) have been deleted.

The items in subsection 3.3.2 formerly on page 12 have been gathered in a single paragraph on page 7 in the same subsection. 

\item
\emph{Caption of Bode plots}
For the sake of compacity the captions have been shorten. The term spatial magnitude bode plot is redundant. (These plots were present on pages 10 and 14, they are now on pages 5 and 7).

\item
\emph{Subsection 1.4, Findings and conclusion from the theoretical study}
(Formerly pages 13 and 14, now page 8). So the article could be more compact the items have been changed into a series of paragraphs. The wording has not been altered.

\item
\emph{Numerical study}
Figure 10 page 18 was redundent with Figure 13 page 20. It has been removed to save space.
Figure 11 page 11 was not necessary to the numerical validation as a sanity check is performed on estimated flow quantities. It has been removed.
Items of subsection 4.5, Findings and conclusion from the numerical experiments, have been turned into a list of paragraphs in order to make the article more compact.

\item
\emph{Appendix}
The appendix was only giving small details about how to derive numerical expression for Fourier coefficients inside the resolution domain. This is all based on well known Inverse Laplace transform analytical expressions.

\end{itemize}

\bigskip{}

3. The authors discussed second order models in the literature survey on traffic flow models but some important literature on it is missing as A. K. Gupta, V. K. Katiyar, Physica A 371 (2006) 674-682;  A. K. Gupta, I. Dhiman, Int. J. Mod. Phys. C, 25 (2014) 1450045; A. K. Gupta, I. Dhiman, Nonlinear Dynamics, DOI: 10.1007/s11071-014-1693-6; A. K. Gupta, (2013), Int. J. Mod. Phys. C, 25(4) 1350018; A. K. Gupta and V. K. Katiyar, Journal of Physics A, 38, (2005), 4069-4083; A. K. Gupta and V. K. Katiyar, Physica A, 368 (2), (2006) 551-559.

\bigskip{}

\emph{
Since the articles deals with the traffic flow control, the relevant articles on it need to be mentioned as A. K. Gupta, S. Sharma, Chin. Phys. B, 19, (2010) 110503; A. K. Gupta, S. Sharma, Chin. Phys. B, 21, (2012) 015201.
}

\bigskip{}

\emph{
It is concluded that "linearized ARZ model is capable of reproducing NGSIM data accurately for a homogeneous segment of the US-101 freeway" is not correct. Some error analysis need to done to support the fact.
}

\bigskip{}

\emph{
There are so many parameters involved in this study which may be confusing for the reader.
}

We thank the reviewer for pointing out that issue. The number of parameters has been reduced as much as possible and reminders of the meaning of the parameters have been added throughout the article.

\begin{itemize}
\item Equation formerly 15 page 5, now 10 page 3, has been rewritten so no new variables are necessary.
\item Page 6 has been entirely rewritten so as to be more simple and more concise. It now corresponds to subsection 2.2 page 3. The diagonalization is only fully written the system of coordinates (v,q) (the most interesting to us) and the number of variables involved is much lower. Equations (17) to (25) only referred to standard linear operations (diagonalization, inversion of a matrix, change of vector basis) which are easy to derive for the reader. The message conveyed by the \textit{Characteristic form} subsection remains intact as finding the characteristic system of coordinates of a linear system only comes down to diagonalizing a real matrix. Everything is now contained in equations (14) and (15) page 3.
\item A reminder of what $Q(\rho)$ (flow equilibrium function) means has been added to the second line of section 3.2.2 (formerly page 9 and now 5) so as to make notations easier to understand.
\end{itemize}

\bigskip{}

Due to all the above point this article cannot be published in this form. If the authors carefully revised the article based upon my comments, then the article may be acceptable for publication.




\newpage

Reviewer C: This paper develops a qualitative analysis of a traffic flow model, which is developed from Aw and Rascle model. The approach uses known techniques and definitely contributes to a deeper understanding of the AR model. However, reference to the existing literature must be improved. For instance the authors ignore a paper by Degond and Delitala which has the ability to depict the velocity diagram without artificially inserting it into the model. This is an important issue which deserves attention as interactions at the micro-scale should lead to such equilibrium configuration; see Bellouquid-Fermo-De Angelis.

Finally, I do *not* think that this paper contributes to a deeper understanding of the physics of traffic so I am not keen to recommend publication.

\section*{References}
\bibliography{biblio}

\end{document}

